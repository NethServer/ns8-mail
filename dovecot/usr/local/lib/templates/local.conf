#
# NS8 override default configuration
#

instance_name = ${instance_name}
login_trusted_networks = ${login_trusted_networks}
protocols = ${protocols} sieve
mail_plugins = ${mail_plugins}

#
# 10-auth
#
disable_plaintext_auth = no
auth_mechanisms = plain login

#
# 10-logging
#
log_path = syslog

#
# 10-mail
#
mail_location = maildir:~/Maildir
mail_home = /var/lib/vmail/%Ln
mail_uid = vmail
mail_gid = vmail
first_valid_uid = 100
last_valid_uid = 100
first_valid_gid = 101
last_valid_gid = 101

#
# 10-ssl
#
ssl = required

#
# 20-submission
#
submission_relay_host = ${submission_host}
submission_relay_port = ${submission_port}
submission_relay_trusted = yes

#
# 20-lmtp
#
service lmtp {
   inet_listener lmtp {
      port = 24
   }
}

#
# 90-sieve
#
plugin {
  sieve_plugins = # sieve_extprograms sieve_imapsieve
}
service managesieve-login {
  inet_listener sieve_deprecated {
    port = 2000 # still used by WebTop?
  }
}
protocol lmtp {
  mail_plugins = ${mail_plugins} sieve
}


# Authentication + Users LDAP backend
passdb {
  driver = ldap
  args = /etc/dovecot/passdb.conf.ext
}
userdb {
  driver = dict
  result_success = continue
  args = /etc/dovecot/acl_groups.conf.ext
}

# Default quota storage is ${quota_rule_storage}M
# an auxiliary userdb with custom quota values can
# be included in the following line if greater than 0:
${condinclude_local_quota}

userdb {
  # Read user from passdb
  driver = prefetch
}
userdb {
  driver = ldap
  args = /etc/dovecot/userdb.conf.ext
}
